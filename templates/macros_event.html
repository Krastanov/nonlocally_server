{% macro event(date, speaker, affiliation, title, abstract, bio, warmup, showvideo, footer) %}
<div class="panel panel-default" id="panel-{{date}}">
  <div class="panel-heading">
    <p>{{date}}</p>
    <h2><a href="/event/{{date}}/{{warmup}}">{{speaker | e}}</a> <span class="badge badge-secondary">{{affiliation}}</span></h2>
  </div>
  <div class="panel-body">
  <h2><a href="/event/{{date}}/{{warmup}}">{{title | e}}</a></h2>
  <div style="white-space:pre-wrap">{{abstract | e}}</div>
  <h4>Speaker's Bio</h4>
  <div style="white-space:pre-wrap">{{bio | e}}</div>
  </div>
  {% if warmup %}
  <strong>This was a short "warmup" talk for <a href="/event/{{date}}/{{warmup}}">another talk</a>.</strong>
  {% else %}
  {% if showvideo %}
  <div style="margin:1em;">
  <video id="video{{date | replace(" ","_") | replace(":","_")}}-{{warmup+0}}" controls style="width:100%" preload="none" poster="/video/poster/{{date}}-{{warmup+0}}.jpg"></video>
<script src="/static/hls.js"></script>
<script>
  (function (){
  var video = document.getElementById('video{{date | replace(" ","_") | replace(":","_")}}-{{warmup+0}}');
  var videoSrc = '/video/hls/{{date | replace(" ","_") | replace(":","_")}}-{{warmup+0}}.m3u8';
  var videoSrcmp4="/video/{{date}}-{{warmup+0}}.mp4";
  if (video.canPlayType('application/vnd.apple.mpegurl')) {
    video.src = videoSrc;
  } else if (Hls.isSupported()) {
    var hls = new Hls();
    hls.loadSource(videoSrc);
    hls.attachMedia(video);
  } else {
    video.src = videoSrcmp4;
  }
  })();
</script>
  </div>
  {% endif %}
  {% endif %}
  <div class="panel-footer">
  {{footer}}
  </div>
</div>
{% endmacro %}
